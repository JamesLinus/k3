<html><head>
      <meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-1">
   <title>Chapter&nbsp;2.&nbsp;Language Reference</title><meta name="generator" content="DocBook XSL-NS Stylesheets V1.75.2"><link rel="home" href="user_documentation.html" title="K3 User Documentation"><link rel="up" href="user_documentation.html" title="K3 User Documentation"><link rel="prev" href="ch01.html" title="Chapter&nbsp;1.&nbsp;Presentation"><link rel="next" href="ch02s02.html" title="Advanced"></head><body bgcolor="white" text="black" link="#0000FF" vlink="#840084" alink="#0000FF"><div class="navheader"><table width="100%" summary="Navigation header"><tr><th colspan="3" align="center">Chapter&nbsp;2.&nbsp;Language Reference</th></tr><tr><td width="20%" align="left"><a accesskey="p" href="ch01.html">Prev</a>&nbsp;</td><th width="60%" align="center">&nbsp;</th><td width="20%" align="right">&nbsp;<a accesskey="n" href="ch02s02.html">Next</a></td></tr></table><hr></div><div class="chapter" title="Chapter&nbsp;2.&nbsp;Language Reference"><div class="titlepage"><div><div><h2 class="title"><a name="_language_reference"></a>Chapter&nbsp;2.&nbsp;Language Reference</h2></div></div></div><div class="toc"><p><b>Table of Contents</b></p><dl><dt><span class="section"><a href="ch02.html#_basic">Basic</a></span></dt><dd><dl><dt><span class="section"><a href="ch02.html#_creating_an_aspect_on_a_class">Creating an aspect on a class</a></span></dt><dt><span class="section"><a href="ch02.html#_using_aspect_from_another_k3_xtend_program">Using aspect from another k3/xTend program</a></span></dt><dt><span class="section"><a href="ch02.html#_extending_an_aspect_classic_inheritance">Extending an aspect (classic inheritance)</a></span></dt><dt><span class="section"><a href="ch02.html#_calling_a_super_operation">Calling a super operation</a></span></dt></dl></dd><dt><span class="section"><a href="ch02s02.html">Advanced</a></span></dt><dd><dl><dt><span class="section"><a href="ch02s02.html#_extending_an_aspect_multi_inheritance">Extending an aspect (multi inheritance)</a></span></dt></dl></dd></dl></div><div class="section" title="Basic"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="_basic"></a>Basic</h2></div></div></div><div class="section" title="Creating an aspect on a class"><div class="titlepage"><div><div><h3 class="title"><a name="_creating_an_aspect_on_a_class"></a>Creating an aspect on a class</h3></div></div></div><div class="orderedlist"><ol class="orderedlist" type="1"><li class="listitem">Add the annotation <span class="emphasis"><em><span class="strong"><strong>Aspect</strong></span></em></span> on the class corresponding to the aspect</li><li class="listitem">Specify the class to augment using the annotation parameter <span class="strong"><strong>className</strong></span></li><li class="listitem">Update the imported packages using <span class="strong"><strong>ctrl+shift+o</strong></span></li></ol></div><p>Let&#8217;s start from a classic class <span class="emphasis"><em>Foo</em></span> that we will extend with aspects.</p><pre class="programlisting">package mypackage
class Foo{
    def void hello(){
        println("Hello from Foo")
    }
}</pre><p>now we will add a aspect on it.</p><pre class="programlisting">package mypackage

import fr.inria.triskell.k3.Aspect

import mypackage.Foo

@Aspect(className=Foo)
class FooAspect {
    def void display (){
         prinln("I am FooAspect")
    }
}</pre><p>In an aspect you can use the attributes and operations of both the augmented class and the aspect itself.</p><p>In aspects <span class="strong"><strong>the keyword</strong></span> "<span class="emphasis"><em><span class="strong"><strong>this</strong></span></em></span>" <span class="strong"><strong>must not be used</strong></span>.
Instead, the keyword "<span class="strong"><strong>_self</strong></span>" must be used.</p><pre class="programlisting">@Aspect(className=BaseClass)
class BaseClassAspect {
    int anInteger = 1

    def void display (){
         // The keyword _self must be used to refer to attributes and operations of the class and aspect.
         _self.anInteger = 2
         _self.hello()
    }
}</pre><p>Despite it should be legal, due to a bug in xtend, we <span class="strong"><strong>do not</strong></span> recommand the following syntax:</p><pre class="programlisting">@Aspect(className=typeof(OtherClass))</pre><p>It may raise strange scope issue, especially in case of aspects defined in several packages.</p></div><div class="section" title="Using aspect from another k3/xTend program"><div class="titlepage"><div><div><h3 class="title"><a name="_using_aspect_from_another_k3_xtend_program"></a>Using aspect from another k3/xTend program</h3></div></div></div><p>To use the aspect, you need to import the correct classes and indicates to xTend thant some additionnal feautres can come from the aspect.</p><p>This is done using the special import <span class="strong"><strong>import static extension</strong></span> which enable the use of the additions declared in the aspect.</p><pre class="programlisting">package mypackage

import mypackage.Foo
import mypackage.FooAspect

import static extension mypackage.FooAspect.*

class Main {
    def static void main(){
      val Foo f1 = new Foo
      f1.display()
    }
}</pre><p>TODO: ajouter dans un callout To use the operations and attributes added in a class, you have to import the aspect:
<span class="emphasis"><em>import static extension myPkg.AspectName.*</em></span></p><div class="section" title="Disambiguisation"><div class="titlepage"><div><div><h4 class="title"><a name="_disambiguisation"></a>Disambiguisation</h4></div></div></div><p>If several operations or attributes have similar names, xTend may not find the expected feature.
In that case you need to disambiguise the call by accessing the underlying helper class.</p><p><span class="emphasis"><em>* TODO *</em></span> show an example of direct, non ambiguious call using the underlying helper class.</p><pre class="screen">Be careful when cleaning unused imports while your programs isn't complete (for example using **ctrl+shift+o**) because it will also removed unused static extension and will disable the code completion (**ctrl+space**) for the features of these aspects.</pre></div></div><div class="section" title="Extending an aspect (classic inheritance)"><div class="titlepage"><div><div><h3 class="title"><a name="_extending_an_aspect_classic_inheritance"></a>Extending an aspect (classic inheritance)</h3></div></div></div><p>Extending an aspect can be performed as in Xtend.</p><p>Let&#8217;s consider the class <span class="emphasis"><em>Bar</em></span> that inherits from <span class="emphasis"><em>Foo</em></span></p><p>Let&#8217;s start from a classic class <span class="emphasis"><em>Foo</em></span> that we will extend with aspects.</p><pre class="programlisting">package mypackage
class Bar extends Foo{
    def void hello(){
        println("Hello from Bar")
    }
}</pre><p>However, as for Java, an aspect can directly inherit from only one aspect!</p><pre class="programlisting">package mypackage

import fr.inria.triskell.k3.Aspect
import fr.inria.triskell.k3.OverrideAspectMethod

import mypackage.Foo
import mypackage.Bar

import static extension mypackage.FooAspect.*

@Aspect(className=Bar)
class BarAspect extends FooAspect {
    // Annotation to tag the operation as an operation overloading a super operation
    @OverrideAspectMethod
    def void display(){
      println("I am BarAspect")
    }
}</pre></div><div class="section" title="Calling a super operation"><div class="titlepage"><div><div><h3 class="title"><a name="_calling_a_super_operation"></a>Calling a super operation</h3></div></div></div><p>A call to a super operation can be done by writing <span class="strong"><strong>super_</strong></span> followed by the name of the operation. Do not forget to use <span class="strong"><strong>_self</strong></span> to handle elements of the class or aspect.</p><pre class="programlisting">@Aspect(className=MyClass)
class MyClassAspect extends OtherClassAspect {
    @OverrideAspectMethod
    def void display(){
       _self.super_display()
       prinln("I am MyClassAspect")
    }
}</pre></div></div></div><div class="navfooter"><hr><table width="100%" summary="Navigation footer"><tr><td width="40%" align="left"><a accesskey="p" href="ch01.html">Prev</a>&nbsp;</td><td width="20%" align="center">&nbsp;</td><td width="40%" align="right">&nbsp;<a accesskey="n" href="ch02s02.html">Next</a></td></tr><tr><td width="40%" align="left" valign="top">Chapter&nbsp;1.&nbsp;Presentation&nbsp;</td><td width="20%" align="center"><a accesskey="h" href="user_documentation.html">Home</a></td><td width="40%" align="right" valign="top">&nbsp;Advanced</td></tr></table></div></body></html>